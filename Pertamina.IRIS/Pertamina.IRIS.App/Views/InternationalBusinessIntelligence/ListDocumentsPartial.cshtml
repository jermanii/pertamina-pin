@section Styles {
    <link href="~/lib/owlcarousel/css/owl.carousel.min.css" rel="stylesheet" type="text/css" />
    <link href="~/lib/owlcarousel/css/owl.theme.default.min.css" rel="stylesheet" type="text/css" />
    <link href="~/css/custom.css" rel="stylesheet" type="text/css" />
}

@using Pertamina.IRIS.Models.Base
@inject GlobalVariableBaseModel globalParam
@model Pertamina.IRIS.Models.ViewModels.InternationalBusinessIntelligenceCategoryViewModel
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor


@if (Model.IBICategoryOwn.Count > 0)
{
    <div class="filter-mode d-flex flex-wrap flex-stack mb-3">
        <h4 class="fw-semibold my-2">
            Own Documents
        </h4>
    </div>
    <div class="filter-mode row g-6 g-xl-9 mb-9">
        <div class="owl-carousel owl-theme">
            @foreach (var o in Model.IBICategoryOwn)
            {
                <div class="item">
                    <div class="card h-100 ">
                        <div class="card-header flex-nowrap border-0 p-5">
                            <div class="card-title m-0 d-flex w-75">
                                <h5>@o.Title</h5>
                            </div>
                            <div class="card-toolbar row justify-content-between align-items-center m-0">
                                <a href="@Url.Action("Update","InternationalBusinessIntelligence", new { guid = @o.Id })"
                                   class="fw-bold w-25">
                                    <i class="fa fa-edit"></i>
                                </a>
                                <a href="@Url.Action("DetailDocuments","InternationalBusinessIntelligence", new { guid = @o.Id })"
                                   class="fw-bold w-25">
                                    <i class="fa fa-eye"></i>
                                </a>
                                <a class="fw-bold pointer ibi-download w-25" data-idibi="@o.Id" data-title="@o.Title">
                                    <i class="fa fa-download"></i>
                                </a>
                            </div>
                        </div>
                        <div class="card-body flex-column pt-0 px-5 pb-6 d-inline">
                            <h6 class="fw-semibold">Author:</h6>
                            @{
                                int countAuthor = 0;
                                int totalAuthor = o.Authors.Count;
                                string authorsName = string.Empty;
                            }
                            @foreach (var a in o.Authors)
                            {
                                countAuthor++;
                                authorsName += a.Name;
                                if (countAuthor != totalAuthor)
                                {
                                    authorsName += ", ";
                                }
                            }
                            <span>@authorsName</span>
                            <span class="px-2">|</span>
                            <span class="text-gray">Created @string.Format("{0:MMM, yyyy}", o.ResearchDate)</span>
                            <p class="pt-5">
                                @o.Description
                            </p>
                        </div>
                        <div class="card-body d-flex flex-column pt-0 px-5 pb-3">
                            <h5 class="fw-bold">Countries Covered:</h5>
                            @{
                                int countCountry = 0;
                                int totalCountry = o.RelatedCountry.Count;
                                string countryName = string.Empty;
                            }
                            @foreach (var c in o.RelatedCountry)
                            {
                                countCountry++;
                                countryName += c.NegaraMitra.NamaNegara;
                                if (countCountry != totalCountry)
                                {
                                    countryName += ", ";
                                }
                            }
                            <p>
                                @countryName
                            </p>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
}
@if (Model.IBICategoryMyList.Count > 0)
{
    <div class="filter-mode d-flex flex-wrap flex-stack mb-3">
        <h4 class="fw-semibold my-2">
            My List Documents
        </h4>
    </div>
    <div class="filter-mode row g-6 g-xl-9 mb-9">
        <div class="owl-carousel owl-theme">
            @foreach (var o in Model.IBICategoryMyList)
            {
                <div class="item">
                    <div class="card h-100 ">
                        <div class="card-header flex-nowrap border-0 p-5">
                            <div class="card-title m-0 d-flex w-75">
                                <h5>@o.Title</h5>
                            </div>
                            <div class="card-toolbar row justify-content-between align-items-center m-0">
                                <a href="@Url.Action("Update","InternationalBusinessIntelligence", new { guid = @o.Id })"
                                   class="fw-bold w-25">
                                    <i class="fa fa-edit"></i>
                                </a>
                                <a href="@Url.Action("DetailDocuments","InternationalBusinessIntelligence", new { guid = @o.Id })"
                                   class="fw-bold w-25">
                                    <i class="fa fa-eye"></i>
                                </a>
                                <a class="fw-bold pointer ibi-download w-25" data-idibi="@o.Id" data-title="@o.Title">
                                    <i class="fa fa-download"></i>
                                </a>
                            </div>
                        </div>
                        <div class="card-body flex-column pt-0 px-5 pb-6 d-inline">
                            <h6 class="fw-semibold">Author:</h6>
                            @{
                                int countAuthor = 0;
                                int totalAuthor = o.Authors.Count;
                                string authorsName = string.Empty;
                            }
                            @foreach (var a in o.Authors)
                            {
                                countAuthor++;
                                authorsName += a.Name;
                                if (countAuthor != totalAuthor)
                                {
                                    authorsName += ", ";
                                }
                            }
                            <span>@authorsName</span>
                            <span class="px-2">|</span>
                            <span class="text-gray">Created @string.Format("{0:MMM, yyyy}", o.ResearchDate)</span>
                            <p class="pt-5">
                                @o.Description
                            </p>
                        </div>
                        <div class="card-body d-flex flex-column pt-0 px-5 pb-3">
                            <h5 class="fw-bold">Countries Covered:</h5>
                            @{
                                int countCountry = 0;
                                int totalCountry = o.RelatedCountry.Count;
                                string countryName = string.Empty;
                            }
                            @foreach (var c in o.RelatedCountry)
                            {
                                countCountry++;
                                countryName += c.NegaraMitra.NamaNegara;
                                if (countCountry != totalCountry)
                                {
                                    countryName += ", ";
                                }
                            }
                            <p>
                                @countryName
                            </p>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
}
@if (Model.IBICategoryRecently.Count > 0)
{
    <div class="filter-mode d-flex flex-wrap flex-stack mb-3">
        <h4 class="fw-semibold my-2">
            Recently Upload Documents
        </h4>
        <div class="d-flex align-items-center my-2">
        </div>
    </div>
    <div class="filter-mode row g-6 g-xl-9 mb-11">
        <div class="owl-carousel owl-theme">
            @foreach (var r in Model.IBICategoryRecently)
            {
                <div class="item">
                    <div class="card h-100 ">
                        <div class="card-header flex-nowrap border-0 p-5">
                            <div class="card-title m-0 d-flex w-75">
                                <h5>@r.Title</h5>
                            </div>
                            <div class="card-toolbar row justify-content-between align-items-center m-0">
                                <a href="@Url.Action("Update","InternationalBusinessIntelligence", new { guid = @r.Id })"
                                   class="fw-bold w-25">
                                    <i class="fa fa-edit"></i>
                                </a>
                                <a href="@Url.Action("DetailDocuments","InternationalBusinessIntelligence", new { guid = @r.Id })"
                                   class="fw-bold w-25">
                                    <i class="fa fa-eye"></i>
                                </a>
                                <a class="fw-bold pointer ibi-download mx-2 w-25" data-idibi="@r.Id" data-title="@r.Title">
                                    <i class="fa fa-download"></i>
                                </a>
                            </div>
                        </div>
                        <div class="card-body flex-column pt-0 px-5 pb-6 d-inline">
                            <h6 class="fw-semibold">Author:</h6>
                            @{
                                int countAuthor = 0;
                                int totalAuthor = r.Authors.Count;
                                string authorsName = string.Empty;
                            }
                            @foreach (var a in r.Authors)
                            {
                                countAuthor++;
                                authorsName += a.Name;
                                if (countAuthor != totalAuthor)
                                {
                                    authorsName += ", ";
                                }
                            }
                            <span>@authorsName</span>
                            <span class="px-2">|</span>
                            <span class="text-gray">Created @string.Format("{0:MMM, yyyy}", r.ResearchDate)</span>
                            <p class="pt-5">
                                @r.Description
                            </p>
                        </div>
                        <div class="card-body d-flex flex-column pt-0 px-5 pb-3">
                            <h5 class="fw-bold">Countries Covered:</h5>
                            @{
                                int countCountry = 0;
                                int totalCountry = r.RelatedCountry.Count;
                                string countryName = string.Empty;
                            }
                            @foreach (var c in r.RelatedCountry)
                            {
                                countCountry++;
                                countryName += c.NegaraMitra.NamaNegara;
                                if (countCountry != totalCountry)
                                {
                                    countryName += ", ";
                                }
                            }
                            <p>
                                @countryName
                            </p>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
}